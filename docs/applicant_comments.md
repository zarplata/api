# Комментарии к соискателю

* [Список комментариев](#list)
* [Добавление комментария](#add_comment)
* [Обновление комментария](#edit_comment)
* [Удаление комментария](#delete_comment)

<a name="list"></a>
## Список комментариев

Получение списка комментариев доступно только работодателю. Список будет
содержать комментарии текущего пользователя, а также комментарии других
менеджеров компании, если они открыли доступ к ним при публикации.


### Запрос

Нет необходимости собирать url запроса вручную, его нужно получать из
[поля `owner` в резюме](employer_resumes.md#owner-field)

`GET /applicant_comments/{applicant_id}`

где `applicant_id` – идентификатор соискателя.

Дополнительные параметры запроса:

* [параметры пагинации `page` и `per_page`](general.md#pagination)
* `order_by` - сортировка комментариев, доступные значения –
  в [справочнике `applicant_comments_order`](dictionaries.md#etc)


### Ответ

Успешный ответ приходит с кодом `200 OK` и содержит:

```json
{
    "found": 2,
    "page": 0,
    "pages": 1,
    "per_page": 20,
    "items": [
        {
            "author": {
                "full_name": "Иванов Иван Иванович"
            },
            "created_at": "2015-08-27T10:19:55+0300",
            "id": "123456",
            "is_mine": false,
            "text": "обратить внимание на данного кандидата\nсрочно!",
            "access_type": {
                "id": "coworkers",
                "name": "Виден мне и моим коллегам",
            }
        },
        {
            "author": {
                "full_name": "Иванова Мария Ивановна"
            },
            "created_at": "2015-08-27T10:30:14+0300",
            "id": "123654",
            "is_mine": true,
            "text": "не считаю нужным",
            "access_type": {
                "id": "owner",
                "name": "Виден только мне",
            }
        }
    ]
}
```

Имя | Тип | Описание
-----|-----|---------
author.full_name | строка | ФИО автора комментария
created_at | строка (дата) | дата создания комментария
id | строка | уникальный идентификатор комментария
is_mine | логический | комментарий написан текущем пользователем?
text | строка | содержание комментария (текст, который может содержать символы новой строки)
access_type | объект | типа доступа для комментария, возможные значения содержатся в [справочнике applicant_comment_access_type](dictionaries.md#etc)

### Ошибки

* `404 Not Found` – указанный соискатель не найден.
* `403 Forbidden` – получение комментариев не доступно для текущего
  пользователя.


<a name="add_comment"></a>
## Добавление комментария

### Запрос

Нет необходимости собирать url запроса вручную, его нужно получать из
[поля `owner` в резюме](employer_resumes.md#owner-field)

`POST /applicant_comments/{applicant_id}`

где

* `applicant_id` – идентификатор соискателя

Параметры запроса:

* `text` - текст комментария,
* `access_type` - тип доступа (возможные значения содержатся в
  [справочнике applicant_comment_access_type](dictionaries.md#etc))


### Ответ

Успешный ответ приходит с кодом `201 Created` и содержит в теле созданный
комментарий.


```json
{
    "author": {
        "full_name": "Иванова Мария Ивановна"
    },
    "created_at": "2015-08-27T10:30:14+0300",
    "id": "123654",
    "is_mine": true,
    "text": "не считаю нужным",
    "access_type": {
        "id": "owner",
        "name": "Виден только мне",
    }
}
```


### Ошибки

* `403 Forbidden` – если текущий пользователь - не работодатель.
* `404 Not Found` – указанный соискатель не существует.
* `400 Bad argument` – ошибка в параметрах запроса.


<a name="edit_comment"></a>
## Обновление комментария

У существующего комментария можно сменить тип доступа и текст комментария.
Изменять комментарий может только его автор.

### Запрос

Для получения url добавьте id комментария к url [списка комментариев](#list).

`PUT /applicant_comments/{applicant_id}/{comment_id}`

где

* `applicant_id` – идентификатор соискателя,
* `comment_id` – идентификатор комментария.

Параметры запроса:

* `text` - текст комментария,
* `access_type` - тип доступа (возможные значения содержатся в
  [справочнике applicant_comment_access_type](dictionaries.md#etc))

Изменять возможно и текст комментария, и тип доступа. Если параметр не передан,
то значение останется прежним.


### Ответ

Успешный ответ приходит с кодом `204 No Content` и не содержит тела.


### Ошибки

* `403 Forbidden` – если текущий пользователь - не работодатель.
* `404 Not Found` – если указанный соискатель или комментарий не существует.
* `400 Bad argument` – ошибка в параметрах запроса, дополнительно могут быть
  указаны названия параметров с ошибками.


<a name="delete_comment"></a>
## Удаление комментария

Удалять комментарий может только его автор.

### Запрос

Для получения url добавьте id комментария к url [списка комментариев](#list).

`DELETE /applicant_comments/{applicant_id}/{comment_id}`

где
* `applicant_id` – идентификатор соискателя,
* `comment_id` – id комментария, который будет удален

### Ответ

Успешный ответ приходит с кодом `204 No Content` и не содержит тела.

### Ошибки

* `403 Forbidden` – если текущий пользователь - не работодатель
* `404 Not Found` – если указанный соискатель не существует.
